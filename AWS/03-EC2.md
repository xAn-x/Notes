# **EC2 (Elastic Compute Cloud) – Notes**

### 1. What is EC2?     

- Virtual servers in the cloud (Infrastructure as a Service - IaaS).      
- Resizable compute capacity.                
- Pay only for what you use.

---

### 2. Main Features

- **Different instance types** → optimized for compute, memory, storage, GPU.
    
- **OS choice** → Linux, Windows, etc.
    
- **Scalable** → start/stop quickly, scale up/down.
    
- **Networking** → public/private IP, security groups, VPC.
    
- **Storage** → attach EBS volumes or use Instance Store.

    ![[Pasted image 20250901131431.png]]

### Bootstrapping EC2

![[Pasted image 20250901131630.png]]


### Creating an EC2 instance

```
AWS > EC2 > [select your OS & memory] > [key-pair utility for SSH] > [Add security group for traffic controll] > [add script in user-data that will be used or boot-strapping]
```


### EC2 Instance Types

| Instance Family                          | Optimized For                    | Use Cases                                                                                                          |
| ---------------------------------------- | -------------------------------- | ------------------------------------------------------------------------------------------------------------------ |
| **General Purpose (t, m)**               | Balanced CPU, memory, Networking | Web servers, dev/test, small apps                                                                                  |
| **Compute Optimized (c)**                | High CPU                         | Batch processing, media transcoding, ML workloads,high-performance apps                                            |
| **Memory Optimized (r, x, z)**           | Large memory                     | Databases, caching, in-memory analytics                                                                            |
| **Storage Optimized (i, d, h)**          | High storage & IOPS              | Big data, data warehouses, NoSQL DB, High frequency online transaction processing (OLTP),distributed file systemsc |
| **Accelerated Computing (p, g, f, trn)** | GPU/FPGA/AI accelerators         | Machine learning, graphics, HPC                                                                                    |

---

### 3. Pricing Models

- **On-Demand** → pay per second/minute, no commitment.
- **Reserved Instances** → 1 or 3 years, up to 72% cheaper. Pay full-upfront for max discount, recommended for steady-state usage (like databases)
- **Spot Instances** → spare capacity, up to 90% cheaper, can be stopped anytime. Instances that u can "lose" @ any point of time if ur max-price is < current spot price. Not for critical apps.
- **Dedicated Hosts** → physical server reserved for you. Most Expensive.
- **Savings Plans** → commit to $/hr usage, flexible across instances.

![[Pasted image 20250901140118.png]]

---
### 4. **Security Groups (EC2)**

- **Definition**: Virtual firewall that controls traffic to/from EC2 instances. Can be attached to multiple instances
    
- **Stateful**: If inbound is allowed, the response is automatically allowed outbound.
    
- **Default rules**:
    
    - Inbound → all **denied** by default.
    - Outbound → all **allowed** by default.
        
- **Rules**:
    
    - Only **allow rules**, no deny.
    - Based on protocol (TCP/UDP/ICMP), port, and source/destination (IP, CIDR, or another SG).
        
- **Attachment**:
    
    - Attached to **ENI (Elastic Network Interface)**.
        
    - An instance can have multiple Security Groups.
        
    - A Security Group can be shared across many instances.
        
- **Limits**:
    
    - By default: up to **5 SGs per ENI**.
        
    - Each SG: ~60 inbound + 60 outbound rules (soft limit, can be increased).
        
- **Scope**: Works at the **instance level** (not subnet).
    
- **Changes**: Take effect **immediately**, no reboot needed.
    
- **Best practices**:
    
    - Open only the required ports (least privilege).
        
    - Use SG references instead of IPs for internal comms.
        
    - Avoid wide-open rules (`0.0.0.0/0`) for SSH (22) or RDP (3389).

![[Pasted image 20250901133403.png]]
![[Pasted image 20250901133527.png]]

### SSH Overview

#### Linux EC2 (via SSH)

- Generate/download **key pair (.pem)** when launching instance.
    
- Change permissions on key file (only owner can read):
    
    ```bash
    chmod 400 my-key.pem
    ```
    
- Connect using public IP / DNS:
    
    ```bash
    ssh -i my-key.pem ec2-user@<public-ip>
    ```
    
    - Default usernames by AMI:
        - Amazon Linux → `ec2-user`
        - Ubuntu → `ubuntu`
        - CentOS → `centos`
        - RHEL → `ec2-user` or `root`
            
- Security Group must allow **Inbound rule: TCP 22 (SSH)**.

---

#### Windows EC2 (via RDP)

- Generate/download **key pair (.pem)** when launching instance.
    
- Use it to decrypt the **Administrator password** in AWS Console.
    
- Download and open **Remote Desktop file (.rdp)**.
    
- Connect with:
    
    - **Username**: Administrator
        
    - **Password**: decrypted using key pair.
        
- Security Group must allow **Inbound rule: TCP 3389 (RDP)**.
    

---

>[!Note]
>Never put ur aws credentials through terminal (while ssh into ec2), always attach the IAM role for such

![[Pasted image 20250901140246.png]]